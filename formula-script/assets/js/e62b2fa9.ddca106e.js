"use strict";(self.webpackChunkformula_script=self.webpackChunkformula_script||[]).push([[68],{480:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>u});var t=s(4848),c=s(8453);const r={sidebar_position:3},o="Async Functions",i={id:"functions/async-functions",title:"Async Functions",description:"Formula-Script can handle asynchronous functions in case you want to create a function that performs async tasks.",source:"@site/docs/functions/async-functions.md",sourceDirName:"functions",slug:"/functions/async-functions",permalink:"/formula-script/docs/functions/async-functions",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Magic Functions",permalink:"/formula-script/docs/functions/magic-functions"},next:{title:"Configuration",permalink:"/formula-script/docs/config"}},a={},u=[{value:"Register an async function",id:"register-an-async-function",level:3}];function l(n){const e={code:"code",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"async-functions",children:"Async Functions"}),"\n",(0,t.jsx)(e.p,{children:"Formula-Script can handle asynchronous functions in case you want to create a function that performs async tasks."}),"\n",(0,t.jsx)(e.h3,{id:"register-an-async-function",children:"Register an async function"}),"\n",(0,t.jsxs)(e.p,{children:["In order to handle async functions you need to import ",(0,t.jsx)(e.code,{children:"AsyncFormulaScript"})," class"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'import { AsyncFormulaScript } from "formula-script"\n'})}),"\n",(0,t.jsx)(e.p,{children:"Then, just register your function:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'fs = new AsyncFormulaScript();\nfs.registry.register("FETCHUSER", {\n    async call(args) {\n        const id = args.asNumber(0);\n        const data = await fetch("https://jsonplaceholder.typicode.com/users/" + id);\n        const info = await data.json();\n        return info.name;\n    },\n    numParams: 1\n});\n'})}),"\n",(0,t.jsxs)(e.p,{children:["The difference with ",(0,t.jsx)(e.code,{children:"FormulaScript"})," class is that when we execute the run method we will have a promise."]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:'fs.run("FETCHUSER(1)").then(output => {\n    console.log(output); // Leanne Graham\n}).catch(err => {\n    console.log("Error: " + err.message);\n});\n'})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"setCellRefHandler"})," and ",(0,t.jsx)(e.code,{children:"setRangeHandler"})," can be async, too"]}),"\n",(0,t.jsxs)(e.li,{children:["If you try to run an async function with ",(0,t.jsx)(e.code,{children:"FormulaScript"})," class it will throw an error."]}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(l,{...n})}):l(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>i});var t=s(6540);const c={},r=t.createContext(c);function o(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:o(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);