"use strict";(self.webpackChunkformula_script=self.webpackChunkformula_script||[]).push([[647],{201:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});var r=t(781),s=t(5942),l=t(6540),h=t(4353),c=t.n(h),i=t(9878),d=(t(5404),t(4848));function a(){const[e,n]=(0,l.useState)("SUMRANGE(A1:J3)"),[t,h]=(0,l.useState)(""),a=(0,l.useRef)(i.A.highlight('i.current.setRangeHandler((left : string, right: string) => {\n    const colLeft = left[0];\n    const rowLeft = Number(left[1]);\n    const colRight = right[0];\n    const rowRight = Number(right[1]);\n    const cell2index = {\n        "A": 0,\n        "B": 1,\n        "C": 2,\n        "D": 3,\n        "E": 4,\n        "F": 5,\n        "G": 6,\n        "H": 7,\n        "I": 8,\n        "J": 9\n    }\n    const result = [];\n    for(let i = cell2index[colLeft]; i <= cell2index[colRight]; i++) {\n        for(let j = rowLeft - 1; j <= rowRight - 1; j++) {\n            const element = dataSource[j][i];\n            result.push(element);\n        }\n    }\n    return result;\n});',{language:"js"})),o=[[1,2,3,4,5,6,7,8,9,10],[11,12,13,14,15,16,17,18,19,20],[21,22,23,24,25,26,27,28,29,30]],u=(0,l.useRef)(new s.O);(0,l.useEffect)((()=>{u.current.setRangeHandler(((e,n)=>{const t=e[0],r=Number(e[1]),s=n[0],l=Number(n[1]),h={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9},c=[];for(let i=h[t];i<=h[s];i++)for(let e=r-1;e<=l-1;e++){const n=o[e][i];c.push(n)}return c}))}),[]),(0,l.useEffect)((()=>{try{const n=u.current.run(e);n instanceof Date?h(c()(n).format("DD/MM/YYYY")):h(n)}catch(n){n instanceof Error&&h(n.message)}}),[e]);return(0,d.jsx)(r.A,{title:"Test",children:(0,d.jsx)("main",{children:(0,d.jsxs)("div",{className:"container",style:{marginTop:20},children:[(0,d.jsx)("h1",{children:"Demo"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{style:{marginBottom:0},children:"Input"}),(0,d.jsx)("div",{className:"col-md-6",style:{width:"100%",height:"100%",marginRight:5},children:(0,d.jsx)("textarea",{onChange:e=>{n(e.target.value)},style:{width:"100%",height:"100%"},value:e})}),(0,d.jsx)("h4",{style:{marginBottom:0},children:"Output"}),(0,d.jsx)("div",{className:"col-md-6",style:{width:"100%",backgroundColor:"#f5f5f5"},children:t})]}),(0,d.jsx)("br",{}),(0,d.jsx)("h4",{children:"My Spreadsheet"}),(0,d.jsxs)("table",{children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{}),(0,d.jsx)("th",{children:"A"}),(0,d.jsx)("th",{children:"B"}),(0,d.jsx)("th",{children:"C"}),(0,d.jsx)("th",{children:"D"}),(0,d.jsx)("th",{children:"E"}),(0,d.jsx)("th",{children:"F"}),(0,d.jsx)("th",{children:"G"}),(0,d.jsx)("th",{children:"H"}),(0,d.jsx)("th",{children:"I"}),(0,d.jsx)("th",{children:"J"})]})}),(0,d.jsx)("tbody",{children:o.map(((e,n)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{children:(0,d.jsx)("b",{children:n+1})}),e.map((e=>(0,d.jsx)("td",{children:e},e)))]},n)))})]}),(0,d.jsx)("h4",{children:"Define a range handler"}),(0,d.jsx)("pre",{children:(0,d.jsx)("code",{className:"language-js",dangerouslySetInnerHTML:{__html:a.current.value}})}),(0,d.jsx)("div",{})]})})})}}}]);