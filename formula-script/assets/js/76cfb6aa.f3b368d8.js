"use strict";(self.webpackChunkformula_script=self.webpackChunkformula_script||[]).push([[313],{9862:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var s=t(4848),r=t(8453);const i={sidebar_position:1},a="Create a Function",o={id:"tutorial-basics/create-a-function",title:"Create a Function",description:"Register a function",source:"@site/docs/tutorial-basics/create-a-function.md",sourceDirName:"tutorial-basics",slug:"/tutorial-basics/create-a-function",permalink:"/formula-script/docs/tutorial-basics/create-a-function",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Tutorial - Basics",permalink:"/formula-script/docs/category/tutorial---basics"},next:{title:"Data types",permalink:"/formula-script/docs/tutorial-basics/data-types"}},c={},l=[{value:"Register a function",id:"register-a-function",level:3},{value:"Arguments class",id:"arguments-class",level:3},{value:"Properties:",id:"properties",level:4},{value:"Methods:",id:"methods",level:4},{value:"FunctionRegistry class",id:"functionregistry-class",level:3},{value:"Methods",id:"methods-1",level:4}];function u(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"create-a-function",children:"Create a Function"}),"\n",(0,s.jsx)(n.h3,{id:"register-a-function",children:"Register a function"}),"\n",(0,s.jsxs)(n.p,{children:["In order to create a function you need to register it in the function registry by using the ",(0,s.jsx)(n.strong,{children:"register"})," function"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'import {FormulaScript} from "formula-script"\n\nconst fs = new FormulaScript();\nfs.registry.register("DOUBLEVALUE", {\n  call: args => {\n    const firstParam = args.asNumber(0); //Get first parameter\n    return firstParam * 2;\n  },\n  numParams: 1 // or numParams: () => 1\n});\n\nconst output = fs.run("DOUBLEVALUE(5)");\nconsole.log(output) //10\n'})}),"\n",(0,s.jsx)(n.p,{children:"As shown above, the first parameter is the function's name while the second is an object that has two parameters:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"call"}),": Here you write your function's code. It accepts a parameter called args. It is an instance of Arguments class."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"numParams"}),": This property is optional and determines the number of parameters your function expects to have. If the property is not defined or if it is null or undefined, the new defined function will accept any amount of parameters."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If there's already a function with the name your're setting, it will be replaced by the new function."}),"\n",(0,s.jsx)(n.h3,{id:"arguments-class",children:"Arguments class"}),"\n",(0,s.jsx)(n.p,{children:"We use this class to get the arguments passed to the function"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import {FormulaScript} from "formula-script"\n\nconst fs = new FormulaScript();\nfs.registry.register("MYFUNCTION", {\n  call: (args: Arguments) => {\n    const firstParam = args.asBool(0); //Get first parameter\n    const secondParam = args.asString(1); //Get second parameter\n    const thirdParam = args.asNumber(2); //Get third parameter\n    const fourthParam = args.asAny(3); //Get fourth parameter\n    const fifthParam = args.asRange(4); //Get fifth parameter\n    //...\n  },\n  numParams: () => 5 //or numParams: 5\n});\n\nfs.run(`MYFUNCTION(TRUE, \'foo\', 10, 15, A1:B5)`);\n'})}),"\n",(0,s.jsx)(n.h4,{id:"properties",children:"Properties:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"length"}),": Returns the amount of parameters passed to the function"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"methods",children:"Methods:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asBool(index : number) : boolean"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and if it's of type ",(0,s.jsx)(n.em,{children:"boolean"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asString(index : number) : string"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and if it's of type ",(0,s.jsx)(n.em,{children:"string"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asNumber(index : number) : number"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and if it's of type ",(0,s.jsx)(n.em,{children:"number"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asDate(index : number) : Date"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and if it's of type ",(0,s.jsx)(n.em,{children:"date"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asAny(index : number) : any"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and it doesn't validate its type."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"asRange(index : number) : RangeArray"}),": Checks whether the argument at position ",(0,s.jsx)(n.em,{children:"index"})," exists and if it's a range."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If any of the previous function's validations fail Formula-Script will throw an error."}),"\n",(0,s.jsx)(n.h3,{id:"functionregistry-class",children:"FunctionRegistry class"}),"\n",(0,s.jsx)(n.p,{children:"The registry object is of type FunctionRegistry. It's used to store the available functions Formula-Script has."}),"\n",(0,s.jsx)(n.h4,{id:"methods-1",children:"Methods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"register(name : string, object : FormulaFunction | ObjectFormulaFunction) : void"}),": Registers a function."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"remove(name : string) : void"}),": Deletes a function from the registry."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"get(name : string) : FormulaFunction | ObjectFormulaFunction"}),": Return the function if found. In case the function does not exists it throws an error."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"rename(name : string, newName : string) : void"}),": Renames a function. In case the function to be renamed does not exists it throws an error."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"has(name : string) : boolean"}),": Checks if a function exists."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var s=t(6540);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);