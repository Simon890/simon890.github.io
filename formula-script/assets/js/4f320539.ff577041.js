"use strict";(self.webpackChunkformula_script=self.webpackChunkformula_script||[]).push([[647],{201:(e,n,r)=>{r.r(n),r.d(n,{default:()=>d});var t=r(781),l=r(5942),s=r(6540),c=r(4353),i=r.n(c),h=r(9878),a=(r(5404),r(4848));function d(){const[e,n]=(0,s.useState)("SUMRANGE(A1:J3)"),[r,c]=(0,s.useState)(""),d=(0,s.useRef)(h.A.highlight('i.current.setRangeHandler((left : string, right: string) => {\n    const colLeft = left[0];\n    const rowLeft = Number(left[1]);\n    const colRight = right[0];\n    const rowRight = Number(right[1]);\n    const cell2index = {\n        "A": 0,\n        "B": 1,\n        "C": 2,\n        "D": 3,\n        "E": 4,\n        "F": 5,\n        "G": 6,\n        "H": 7,\n        "I": 8,\n        "J": 9\n    }\n    const result = [];\n    for(let i = cell2index[colLeft]; i <= cell2index[colRight]; i++) {\n        for(let j = rowLeft - 1; j <= rowRight - 1; j++) {\n            const element = dataSource[j][i];\n            result.push(element);\n        }\n    }\n    return result;\n});',{language:"js"})),o=(0,s.useRef)(h.A.highlight('i.current.setCellRefHandler((cellName, fail) => {\n    if(cellName.length > 2) fail(\'Wrong cell reference\');\n    const col = cellName[0];\n    const row = Number(cellName[1]);\n    const cell2index = {\n        "A": 0,\n        "B": 1,\n        "C": 2,\n        "D": 3,\n        "E": 4,\n        "F": 5,\n        "G": 6,\n        "H": 7,\n        "I": 8,\n        "J": 9\n    }\n    return dataSource[row - 1][cell2index[col]];\n});',{language:"js"})),u=[[1,2,3,4,5,6,7,8,9,10],[11,12,13,14,15,16,17,18,19,20],[21,22,23,24,25,26,27,28,29,30]],j=(0,s.useRef)(new l.On);(0,s.useEffect)((()=>{j.current.setRangeHandler(((e,n)=>{const r=e[0],t=Number(e[1]),l=n[0],s=Number(n[1]),c={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9},i=[];for(let h=c[r];h<=c[l];h++)for(let e=t-1;e<=s-1;e++){const n=u[e][h];i.push(n)}return i})),j.current.setCellRefHandler(((e,n)=>{e.length>2&&n("Wrong cell reference");const r=e[0],t=Number(e[1]);return u[t-1][{A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9}[r]]}))}),[]),(0,s.useEffect)((()=>{try{const n=j.current.run(e);n instanceof Date?c(i()(n).format("DD/MM/YYYY")):"boolean"==typeof n?c(n?"TRUE":"FALSE"):Array.isArray(n)?c(String(n)):c(n)}catch(n){n instanceof Error&&c(n.message)}}),[e]);return(0,a.jsx)(t.A,{title:"Test",children:(0,a.jsx)("main",{children:(0,a.jsxs)("div",{className:"container",style:{marginTop:20},children:[(0,a.jsx)("h1",{children:"Demo"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{style:{marginBottom:0},children:"Input"}),(0,a.jsx)("div",{className:"col-md-6",style:{width:"100%",height:"100%",marginRight:5},children:(0,a.jsx)("textarea",{onChange:e=>{n(e.target.value)},style:{width:"100%",height:"100%"},value:e})}),(0,a.jsx)("h4",{style:{marginBottom:0},children:"Output"}),(0,a.jsx)("div",{className:"col-md-6",style:{width:"100%",backgroundColor:"#f5f5f5"},children:r})]}),(0,a.jsx)("br",{}),(0,a.jsx)("h4",{children:"My Spreadsheet"}),(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{}),(0,a.jsx)("th",{children:"A"}),(0,a.jsx)("th",{children:"B"}),(0,a.jsx)("th",{children:"C"}),(0,a.jsx)("th",{children:"D"}),(0,a.jsx)("th",{children:"E"}),(0,a.jsx)("th",{children:"F"}),(0,a.jsx)("th",{children:"G"}),(0,a.jsx)("th",{children:"H"}),(0,a.jsx)("th",{children:"I"}),(0,a.jsx)("th",{children:"J"})]})}),(0,a.jsx)("tbody",{children:u.map(((e,n)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:(0,a.jsx)("b",{children:n+1})}),e.map((e=>(0,a.jsx)("td",{children:e},e)))]},n)))})]}),(0,a.jsx)("h4",{children:"Define a range handler"}),(0,a.jsx)("pre",{children:(0,a.jsx)("code",{className:"language-js",dangerouslySetInnerHTML:{__html:d.current.value}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{children:"Define a cell reference handler"}),(0,a.jsx)("pre",{children:(0,a.jsx)("code",{className:"language-js",dangerouslySetInnerHTML:{__html:o.current.value}})})]})]})})})}}}]);