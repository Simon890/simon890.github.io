"use strict";(self.webpackChunkformula_script=self.webpackChunkformula_script||[]).push([[265],{1047:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var t=s(4848),a=s(8453);const r={sidebar_position:2},l="Data types",i={id:"tutorial-basics/data-types",title:"Data types",description:"Data types define the type of values that can be manipulated by Formula-Script.",source:"@site/docs/tutorial-basics/data-types.md",sourceDirName:"tutorial-basics",slug:"/tutorial-basics/data-types",permalink:"/formula-script/docs/tutorial-basics/data-types",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Create a Function",permalink:"/formula-script/docs/tutorial-basics/create-a-function"}},o={},c=[{value:"Valid data types",id:"valid-data-types",level:3},{value:"Range - A special data type",id:"range---a-special-data-type",level:3},{value:"Examples",id:"examples",level:4},{value:"How to enable ranges?",id:"how-to-enable-ranges",level:3}];function d(e){const n={code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"data-types",children:"Data types"}),"\n",(0,t.jsx)(n.p,{children:"Data types define the type of values that can be manipulated by Formula-Script."}),"\n",(0,t.jsx)(n.h3,{id:"valid-data-types",children:"Valid data types"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"String"}),": Represents a sequence of characters. It can be between single or multiple quotes."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"fs.run(`CONCAT('First String', \"Second String\")`);\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Number"}),": Represents a number. It can have a fractional part."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"fs.run(`AVG(10, 15.5, .3, -5)`);\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Boolean"}),": Represents truth values, that is ",(0,t.jsx)(n.em,{children:"TRUE"})," or ",(0,t.jsx)(n.em,{children:"FALSE"}),". You can use explicit values as ",(0,t.jsx)(n.em,{children:"TRUE"})," or ",(0,t.jsx)(n.em,{children:"FALSE"})," but can also use boolean comparisons."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"console.log(fs.run(`TRUE`)); //true\nconsole.log(fs.run(`FALSE`)); //false\nconsole.log(fs.run('5 > 5')); //false\nconsole.log(fs.run('5 >= 5')); //true\nconsole.log(fs.run('8 < 7')); //false\nconsole.log(fs.run('8 <= 7')); //false\nconsole.log(fs.run('5 != 3')); //true\nconsole.log(fs.run('10 = 10')); //true\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Range"}),": Represents a set of values."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"fs.run(`AVGRANGE(A1:B5)`);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"range---a-special-data-type",children:"Range - A special data type"}),"\n",(0,t.jsx)(n.p,{children:"A range refers to a collection of cells that have been selected or defined by reference. Ranges are a fundamental part in spreadsheet languages.\nIn Formula-Script, ranges are composed of three parts:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"The left side: Points to the beginning cell."}),"\n",(0,t.jsx)(n.li,{children:"The colon (:) as a separator"}),"\n",(0,t.jsx)(n.li,{children:"The right side: Points to the final cell."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"leftSide"})," + ",(0,t.jsx)(n.em,{children:":"})," + ",(0,t.jsx)(n.em,{children:"rightSide"})]}),"\n",(0,t.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["A1",":B5"]}),"\n",(0,t.jsxs)(n.li,{children:["MyFirstCell",":MyLastCell"]}),"\n",(0,t.jsxs)(n.li,{children:["C10",":F100"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-to-enable-ranges",children:"How to enable ranges?"}),"\n",(0,t.jsx)(n.p,{children:"By default Formula-Script doesn't allow you to use ranges unless you define a range handler.\nWhy? Because FS doesn't know where to get the data from."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"import {FormulaScript} from \"formula-script\"\n\nconst fs = new FormulaScript();\nfs.run(`SUMRANGE(A1:B5)`); //throws an error: No range handler has been set. Use 'setRangeHandler' to set your handler.\n"})}),"\n",(0,t.jsx)(n.p,{children:"To fix this, you just have to define your handler with the 'setRangeHandler' function"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import {FormulaScript} from "formula-script"\n\nconst dataSource = [\n//          A  B   C           D\n/* 1 */    [1, 2,  3,     \'a string\'],\n/* 2 */    [5, 7,  false,          8],\n/* 3 */    [9, 10, 11,          true],\n];\n\nconst fs = new FormulaScript();\nfs.setRangeHandler((left : string, right : string) : Range => {\n  const colLeft = left[0];\n  const rowLeft = Number(left[1]);\n  const colRight = right[0];\n  const rowRight = Number(right[1]);\n  const cell2index = {\n    "A": 0,\n    "B": 1,\n    "C": 2,\n    "D": 3\n  }\n  const result = [];\n  for(let i = mapping[colLeft]; i <= mapping[colRight]; i++) {\n    for(let j = rowLeft - 1; j <= rowRight - 1; j++) {\n      const element = data[j][i];\n      result.push(element);\n    }\n  }\n  return result;\n});\nfs.run(`SUMRANGE(A1:B3)`); //33\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The function ",(0,t.jsx)(n.em,{children:"setRangeHandler"})," accepts a callback function as a parameter. This callback function has two parameters: left and right. It must return a one dimension array. This array can only contain valid data types."]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>i});var t=s(6540);const a={},r=t.createContext(a);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);